<head>
    <meta charset="utf-8">
</head>

{% load staticfiles %}

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="{% static 'js/Chart.js' %}"></script>
{% if solve.is_valid %}
    <input type="hidden" id="input-numbers" value="{{ solve.numbers }}">
    <canvas id="graph-1"></canvas>
    <canvas id="graph-2"></canvas>
    <canvas id="graph-3"></canvas>
    <script type="text/javascript">


        let numbers = document.getElementById('input-numbers').value.split(',').map((value, index) => +value);

        let arr_obj = [];
        let index = [];
        for (let i = 0; i < numbers.length; i++) {
            index.push(i + 1);
            arr_obj.push({x: i, y: numbers[i]});
        }


        new Chart(document.getElementById("graph-1").getContext('2d'), {
            type: 'line',
            // showTooltips: false,
            data: {
                labels: index,
                datasets: [{
                    label: 'asdf',
                    data: arr_obj,
                    borderColor: 'rgba(93,133,245, 1)',
                    borderWidth: 3,
                    fill: false,
                    // steppedLine: false,
                    lineTension: 0,
                    pointBackgroundColor: 'white',
                    pointBorderColor: 'black',
                    pointBorderWidth: 1,
                    pointRadius: 3,
                    pointHoverBackgroundColor: 'black',
                    showLine: true,
                }]
            },
            options: {
                legend: false,
                responsive: true,
                title: {
                    display: true,
                    text: 'Chart.js Line Chart - Logarithmic'
                },
                scales: {
                    xAxes: {
                        display: true,
                        type: 'linear',
                    },
                    yAxes: {
                        display: true,
                        type: 'linear',
                    },
                }
            }
        });


        new Chart(document.getElementById("graph-2").getContext('2d'), {
            type: 'line',
            data: {
                labels: index,
                datasets: [{
                    label: 'Dataset with',
                    data: numbers.sort((a, b) => a - b),
                    borderColor: 'rgba(93,133,245, 1)',
                    borderWidth: 3,
                    fill: false,
                    // steppedLine: false,
                    lineTension: 0,
                    pointBackgroundColor: 'white',
                    pointBorderColor: 'black',
                    pointBorderWidth: 1,
                    pointRadius: 3,
                    pointHoverBackgroundColor: 'black',
                    showLine: true,
                }]
            },
            options: {
                legend: false,
                responsive: true,
                title: {
                    display: true,
                    text: 'Chart.js Line Chart - Logarithmic'
                },
                scales: {
                    xAxes: [{
                        display: true,
                    }],
                    yAxes: [{
                        display: true,
                    }]
                }
            }
        });


        const min = Math.floor(numbers[0]) - 1;
        const max = Math.ceil(numbers[numbers.length - 1]) + 1;


        let t = [];
        for (let i = min; i <= max; i += 0.1) {
            t.push(Math.round(i * 100) / 100);
        }

        let fr = [];
        for (let i = 0; i < t.length; i++) {
            k = 0;
            for (let j = 0; j < numbers.length; j++) {
                if (numbers[j] < t[i]) {
                    k += 1.0 / numbers.length;
                }
            }
            fr.push(k);
        }

        new Chart(document.getElementById("graph-3").getContext('2d'), {
                type: 'line',
                data: {
                    labels: t,
                    datasets: [{
                        label: 'Dataset with',
                        data: fr,
                        borderColor: 'rgba(93,133,245, 1)',
                        borderWidth: 3,
                        fill: false,
                        // steppedLine: false,
                        lineTension: 0,
                        pointBackgroundColor: 'white',
                        pointBorderColor: 'black',
                        pointBorderWidth: 1,
                        pointRadius: 1,
                        pointHoverBackgroundColor: 'black',
                        showLine: true,
                    }]
                },
                options: {
                    legend: false,
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Chart.js Line Chart - Logarithmic'
                    },
                    scales: {
                        xAxes: [{
                            display: true,
                        }],
                        yAxes: [{
                            display: true,
                        }]
                    }
                }
            }
        );
    </script>

{% else %}

    <form action="{{ task.get_absolute_url }}" method="get">
        <div class="form-group">
        <textarea class="form-control"
                  placeholder="Введите генеральную совокупность, состоящую из случайных величин, через запятую: "
                  name="numbers" required="" maxlength="1000" rows="4"></textarea>
        </div>
        <button class="btn btn-success" type="submit">Получить решение!</button>
    </form>

{% endif %}
